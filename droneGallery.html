<!DOCTYPE html>
<html>
<head>
	<title>Drone Gallery</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="shortcut icon" type="image/x-icon" href="docs/images/favicon.ico" />
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css" />
    <link rel="stylesheet" href="droneGalleryCSS.css" />
	<script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"></script>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
</head>
<body>
    <div id="header">
          <div class="wrap">
               <p>Drone Gallery</p>
          </div>
    </div>

    <!-- Drop down menu for change of location -->
    <select id="locationMap"  name="search_type" style="margin-right:10px; margin-top:2px;">
        <option selected="selected" value="directLocation">Location</option>    
        <option value="northbeach">North Beach</option>
        <option value="mexico_rocks">Mexico Rocks</option>
        <option value="belizean_estates">Belizean Estates</option>
        <option value="sewall_marsh">Sewall Marsh</option>
    </select>

    <a href="droneGalleryAdd.html">Add Drone!</a>

    <!-- map -->
    <div id="mapid"></div>
    
    <script>

        var mymap = L.map('mapid').setView([ 43.723877, -69.829684], 15);

        //Open Street Map
        L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
            maxZoom: 18,
            attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
                '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
                'Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
            id: 'mapbox.streets'
        }).addTo(mymap);

        //Update location on map based on dropdown
        // go into CSV file and file address that matches & then get x & y...
        $("#locationMap").change(function() {
            var addr = ($('#locationMap').val());
            //console.log(addr);
            if (addr == "northbeach"){
                mymap.setView([31.689536, -81.135932],16);
            }
            if (addr == "mexico_rocks"){
                mymap.setView([17.976048, -87.935484],16);
            }
            if (addr == "belizean_estates"){
                mymap.setView([17.976048, -87.935484],16);
            }
            if (addr == "sewall_marsh"){
                mymap.setView([43.723877, -69.829684],16);
            }
          });


        
        //display each drone images on map from GeoServer
        function droneGallery(location){
            L.tileLayer.wms("http://discovery.ad.smith.edu:8080/geoserver/wms", {
                layers: 'dronegallery:'+location+'',
                format: 'image/png',
                version: '1.1.0',
                transparent: true,
                attribution: "",
                tiled:true
            }).addTo(mymap);
        }

        //list of drone images uploaded geoserver
        var listLocations = ["northbeach", "mexico_rocks", "belizean_estates", "sewall_marsh"];
        var JSONex = {"0":"1","1":"2","2":"3","3":"4"};


        //loop through listLocations, to upload each item onto map
        for (var i = 0; i<listLocations.length; i++){
            droneGallery(listLocations[i]);
        }

    </script>
</body>
</html>


<!-- https://www.html5rocks.com/en/tutorials/file/dndfiles/
uploads?

 -->

 <!-- 
 http://stackoverflow.com/questions/20881213/converting-json-object-into-javascript-array

 JSON - store location (nameID, location coor)

 then somehow append to it JSON
 order JSON alphabetically
 & append to dropdown menu/change map based on location coor


 -->




<script type="text/javascript">
//May add later:
// popup attributes
// mymap.addEventListener('click', onMapClick);

// popup = new L.Popup({maxWidth: 400});

// function onMapClick(e) {

//     var BBOX = mymap.getBounds().toBBoxString();
//     var WIDTH = mymap.getSize().x;
//     var HEIGHT = mymap.getSize().y;
//     var X = Math.round(mymap.layerPointToContainerPoint(e.layerPoint).x);
//     var Y = Math.round(mymap.layerPointToContainerPoint(e.layerPoint).y);
//     var URL = 'http://discovery.ad.smith.edu:8080/geoserver/wms/?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&layers=dronegallery:northbeach,dronegallery:mexico_rocks,dronegallery:belizean_estates&BBOX='+BBOX+'&FEATURE_COUNT=5&info_format=application/json&propertyName=appcode,url&HEIGHT='+HEIGHT+'&WIDTH='+WIDTH+'&query_layers=dronegallery:northbeach,dronegallery:mexico_rocks,dronegallery:belizean_estates&SRS=EPSG:4326&buffer=15&X='+X+'&Y='+Y;  
//     popup.setLatLng(e.latlng);
//     popup.setContent("<iframe src = '"+URL+"' width='300' height= '100' framreborder = '0'></iframe>");
//     mymap.openPopup(popup);
</script>
